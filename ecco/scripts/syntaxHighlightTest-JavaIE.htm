<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<html>
<head>
	<title>Untitled</title>
	<style>
	body {font-family:"courier new";font-size:12px;margin-left:20px;}
	b,i,s {display:inline;font-size:12px;font-weight:bold;font-style:normal;text-decoration:none;}
	b {color:#7F0055;} /* reserved words */
	i, i b, i s {color:#3F7F5F;} /* comments */
	s {color:#2A00FF;} /* strings */

	P {margin:0;padding:0;border:0;outline:0;}
	</style>
</head>
<script>

function addText() {
	var range = document.selection.createRange();
	range.text = "";
	x = document.getElementById('edt').innerHTML;
//	x = x.replace(/<P>&nbsp;<\/P>/g,'');
	x = x.replace(/<[bis]>|<\/[bis]>/g,'');
	x = x.replace(/([\"\'].*?[\"\'])/g,'<s>$1</s>'); // strings
	x = x.replace(/(public|class|import|private|static|final|new|extends|long|return|continue|null|false|true|throws|boolean|void|try|if|for|switch|catch|int|else)([ \"\'\{\(;])/g,'<b>$1</b>$2');
	x = x.replace(/\/\/(.*?)<br>/g,'<i>//$1</i><br>');
	x = x.replace(/\/\*(.*?)\*\//g,'<i>/*$1*/</i>');
	document.getElementById('edt').innerHTML = x;
}

function showContent() {
	alert(document.getElementById('edt').innerHTML);
}

function keyHandler (evt) {
	evt = (evt) ? evt : (window.event) ? event : null;
  	if (evt) {
    	var charCode = (evt.charCode) ? evt.charCode : ((evt.keyCode) ? evt.keyCode : ((evt.which) ? evt.which : 0));
	    if (charCode == 13||charCode == 32) {
			addText();
		  	findString('');
		}
	}    
}

var TRange=null  
function findString (str) {
	var strFound;
	if (navigator.appName=="Netscape") { // FF
		strFound=self.find(str);
		if (!strFound) {
		   strFound=self.find(str,0,1)
		   while (self.find(str,0,1)) continue
	    }
	}
	if (navigator.appName.indexOf("Microsoft")!=-1) { // IE
		if (TRange!=null) {
			TRange.collapse(false)
			strFound=TRange.findText(str)
			if (strFound) TRange.select()
		}
	  	if (TRange==null || strFound==0) {
		    TRange=self.document.body.createTextRange()
			strFound=TRange.findText(str)
		   	if (strFound) TRange.select();
  		}
	}
}

/*
	theKey = (evt.which || evt.charCode || evt.keyCode);
  	if(theKey==32||theKey==13) { 
		addText();
	  	findString('')
	}*/


document.onkeypress = keyHandler;
</script>
<body>

<div>
<div style="width:100%;height:100%;border:1px solid black" contenteditable="true" id="edt">
import java.io.File;
import java.io.FileFilter;
import java.io.IOException;
import java.io.PrintWriter;

import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

//TODO fix those out.write()

/**
 * Project ECCO - File manager class
 * 
 * @author Fernando M.A.d.S.
 *
 */
public class FileManager extends HttpServlet {

	private static final long serialVersionUID = 1L;
	
	private static String login = "feanndor"; // session var here
	private static String usersPath = System.getProperty("user.dir")+File.separator+"htdocs"+File.separator+"ecco"+File.separator+"users"+File.separator;
	private static File dir = new File(usersPath+login+File.separator);
	static boolean existDirectories = false;
	static int isDirectory = 0;

	public FileFilter filterFiles(File dir) {
		return (new FileFilter() {
			public boolean accept(File pathname) {
				return !(pathname.isDirectory());
			}
		});
	}

	public void listProjects(File dir, PrintWriter out) {
		try{
			File[] dirs = dir.listFiles();
			for (int i = 0; i &lt; dirs.length; i++) {
				if (dirs[i].isDirectory()) {
					out.write("&lt;project name="+dirs[i].getName()+"&gt;");
				} else {
					continue;
				}
				listDir(dirs[i],out);
				out.write("&lt;/project&gt;");
			}
			File[] files = dir.listFiles(filterFiles(dir));
			for (int i = 0; i &lt; files.length; i++) {
				System.out.println(files[i].getName());
			}
		}catch(Exception e){
			out.println("&lt;info&gt;error&lt;/info&gt;");
			return;
		}
	}
}

</div>
</div>
</body>
</html>

