<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<html>
<head>
	<title>Untitled</title>
	<style>
	body {font-family:"courier new";font-size:12px;margin-left:20px;}
	b,i,s,em,strong {display:inline;font-size:12px;font-weight:normal;font-style:normal;text-decoration:none;}
	b {color:#000080;} /* reserved words */
	i, i b, i s {color:silver;font-style:italic;} /* comments */
	s {color:#0000ff;} /* strings */
	em {color:#800000;}
	strong {color:#800080;}	
	</style>

<script>
function init() {
	document.designMode = "On";
	document.addEventListener('keypress', keyHandler, true);
	addText();
}

function addText() {
	document.execCommand("inserthtml", false, '&#127;');
	x = document.body.innerHTML;
	x = x.replace(/<(b|i|s|strong|em)>|<\/(b|i|s|strong|em)>/g,'');
	x = x.replace(/&lt;(.*?)&gt;/g,'<b>&lt;$1&gt;</b>');
	x = x.replace(/=([\"\'].*?[\"\'])/g,'=<s>$1</s>');	
	x = x.replace(/(&lt;style.*?&gt;)(.*?)(&lt;\/style&gt;)/g,'$1<strong>$2</strong>$3');
	x = x.replace(/(&lt;script.*?&gt;)(.*?)(&lt;\/script&gt;)/g,'$1<em>$2</em>$3');
	x = x.replace(/&lt;!--(.*?)--&gt;/g,'<i>&lt;!--$1--&gt;</i>');
	document.body.innerHTML = x;
}

function txtSave() {
	x = document.body.innerHTML;
	x = x.replace(/<b .*?>|<\/b>/g,'');
	alert(x);
}

function keyHandler (evt) {
	theKey = (evt.which || evt.charCode || evt.keyCode);
  	if(theKey==32||theKey==13) { 
		addText();
	  	findString('')
	}
}
 
var TRange=null
function findString (str) {
	var strFound;
	if (navigator.appName=="Netscape") { // FF
		strFound=self.find(str);
		if (!strFound) {
		   strFound=self.find(str,0,1)
		   while (self.find(str,0,1)) continue
	    }
	}
	if (navigator.appName.indexOf("Microsoft")!=-1) { // IE
		if (TRange!=null) {
			TRange.collapse(false)
			strFound=TRange.findText(str)
			if (strFound) TRange.select()
		}
	  	if (TRange==null || strFound==0) {
		    TRange=self.document.body.createTextRange()
			strFound=TRange.findText(str)
		   	if (strFound) TRange.select();
  		}
	}
}

</script>
</head>

<body onload="init()"><pre>
&lt;body&gt;
</pre>
</body>
</html>
