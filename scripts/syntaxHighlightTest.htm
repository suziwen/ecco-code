<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<html>
<head>
	<title>Untitled</title>
	<style>
	b {}
	b.for {color:red;}
	b.if {color:gray;}
	b.quote {color:blue;}
	</style>
<script>
function init() {
	document.designMode = "On";
	document.addEventListener('keypress', keyHandler, true);
}

function addText() {
	document.execCommand("inserthtml", false, '&#127;');
	x = document.body.innerHTML;
	x = x.replace(/([^>\"])for/g,'$1<b class="for">for</b>');
	x = x.replace(/([^>\"])if/g,'$1<b class="if">if</b>');
//	x = x.replace(/[^>](\".*?\")/,'<b class=quote>$1</b>');
	document.body.innerHTML = x;
}

function keyHandler (evt) {
	theKey = (evt.which || evt.charCode || evt.keyCode);
  	if(theKey==13) { 
		addText();
	  	findString('')
//		alert(document.body.innerHTML)
	}
}
 
var TRange=null
function findString (str) {
	var strFound;
	if (navigator.appName=="Netscape") { // FF
		strFound=self.find(str);
		if (!strFound) {
		   strFound=self.find(str,0,1)
		   while (self.find(str,0,1)) continue
	    }
	}
	if (navigator.appName.indexOf("Microsoft")!=-1) { // IE
		if (TRange!=null) {
			TRange.collapse(false)
			strFound=TRange.findText(str)
			if (strFound) TRange.select()
		}
	  	if (TRange==null || strFound==0) {
		    TRange=self.document.body.createTextRange()
			strFound=TRange.findText(str)
		   	if (strFound) TRange.select();
  		}
	}
}

</script>
</head>

<body onload="init()">
sdfsdf
asdf asdfa sdfasdf
</body>

</html>
